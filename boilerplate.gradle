apply plugin: 'java'
apply plugin: 'idea'

if(!project.ext.has('java')) {
  project.ext.set("java", "8");
}

sourceCompatibility = "1.$project.java"
targetCompatibility = "1.$project.java"


//generated sources

def genSrcDir = 'src/gen/main'
def genTestSrcDir = 'src/gen/test'

[genSrcDir, genTestSrcDir].each{dir -> file(dir).mkdirs()}

idea {
  module {
    sourceDirs += file(genSrcDir)
    testSourceDirs += file(genTestSrcDir)
  }
}
compileJava.options.compilerArgs = ['-s', genSrcDir]
compileTestJava.options.compilerArgs = ['-s', genTestSrcDir]

clean << {
  delete 'gen'
}


repositories {
    mavenCentral()
}

dependencies {
    compile 'com.google.guava:guava:14.0-rc1'

    testCompile 'junit:junit:4.11'
    testCompile 'org.easytesting:fest-assert:1.4'
}
